<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ordering - relm4-store</title>


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../01-birth.html"><strong aria-hidden="true">1.1.</strong> How the data stores came to life</a></li><li class="chapter-item expanded "><a href="../../02-goals.html"><strong aria-hidden="true">1.2.</strong> Goals</a></li><li class="chapter-item expanded "><a href="../../03-relm4-vs-store.html"><strong aria-hidden="true">1.3.</strong> relm4 vs store</a></li><li class="chapter-item expanded "><a href="../../04-application_architecture.html"><strong aria-hidden="true">1.4.</strong> Application architecture</a></li></ol></li><li class="chapter-item expanded "><a href="../../examples/index.html"><strong aria-hidden="true">2.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../examples/01-setup.html"><strong aria-hidden="true">2.1.</strong> Setup</a></li><li class="chapter-item expanded "><a href="../../examples/01-todo/index.html"><strong aria-hidden="true">2.2.</strong> Simple todo 1</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../examples/01-todo/01-model.html"><strong aria-hidden="true">2.2.1.</strong> Model</a></li><li class="chapter-item expanded "><a href="../../examples/01-todo/02-store.html"><strong aria-hidden="true">2.2.2.</strong> Store</a></li><li class="chapter-item expanded "><a href="../../examples/01-todo/03-task_list.html"><strong aria-hidden="true">2.2.3.</strong> View - Task list</a></li><li class="chapter-item expanded "><a href="../../examples/01-todo/04-main_window.html"><strong aria-hidden="true">2.2.4.</strong> View - Main window</a></li><li class="chapter-item expanded "><a href="../../examples/01-todo/05-main.html"><strong aria-hidden="true">2.2.5.</strong> main</a></li><li class="chapter-item expanded "><a href="../../examples/01-todo/06-configuration.html"><strong aria-hidden="true">2.2.6.</strong> configuration</a></li></ol></li><li class="chapter-item expanded "><a href="../../examples/02-todo/index.html"><strong aria-hidden="true">2.3.</strong> Simple todo 2</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../examples/02-todo/01-generate-tasks.html"><strong aria-hidden="true">2.3.1.</strong> Generating tasks</a></li><li class="chapter-item expanded "><a href="../../examples/02-todo/02-updating-store-view.html"><strong aria-hidden="true">2.3.2.</strong> Updating store view</a></li><li class="chapter-item expanded "><a href="../../examples/02-todo/03-updating_taks_list.html"><strong aria-hidden="true">2.3.3.</strong> Updating task list</a></li></ol></li><li class="chapter-item expanded "><a href="../../examples/03-todo/index.html"><strong aria-hidden="true">2.4.</strong> Simple todo 3</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../examples/03-todo/01-ordering.html" class="active"><strong aria-hidden="true">2.4.1.</strong> Ordering</a></li><li class="chapter-item expanded "><a href="../../examples/03-todo/02-custom_sorting.html"><strong aria-hidden="true">2.4.2.</strong> Custom sorting</a></li><li class="chapter-item expanded "><a href="../../examples/03-todo/03-view.html"><strong aria-hidden="true">2.4.3.</strong> View</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">relm4-store</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ordering"><a class="header" href="#ordering">Ordering</a></h1>
<h2 id="natural-order"><a class="header" href="#natural-order">Natural order</a></h2>
<p>Natural order is the order in which your store returns data when no sorting is applied. The important thing to remember is if you implement your store
make sure natural order is stable. Otherwise to make your application useful either you would need to make sure you always apply sorting or you might
end up with application where every time interface is refreshed due to data changes being propagated, your whole ui shuffles. This will be terrible
from user point of view.</p>
<p>All examples until now we were using <code>InMemoryBackend</code> for which natural order is defined as order in which records where added. In this example we will switch to
<code>SortedInMemoryBackend</code> where we can change natural order of elements.</p>
<h2 id="sorting-behavior"><a class="header" href="#sorting-behavior">Sorting behavior</a></h2>
<p>There are two ways in which sorting work while you use data store. First is global sorting or natural order. You apply it to the store and store rebuilds itself so
natural order becomes the one which you had requested. This will cause update in all store views. Second way is to apply sorting to the store view.
This will make store view from now to ask the data to be ordered by the given property. Result seen by the view is equivalent of
<code>store view ordering(natural order(data))</code>.</p>
<p>If you define the ordering what was originally append at the end of the store might become insert somewhere in the middle of the data set. This might
lead to undesired side effects on the ui side. To give you power to decide what should happen you can use implementation of <code>store::window::WindowBehavior</code>.
By default in <code>relm4-store</code> there are implemented four kinds of window behaviors.</p>
<ol>
<li>PositionTrackingWindow</li>
<li>ValueTrackingWindow</li>
<li>KeepOnTop</li>
<li>KeepOnBottom</li>
</ol>
<h3 id="storewindowpositiontrackingwindow"><a class="header" href="#storewindowpositiontrackingwindow"><code>store::window::PositionTrackingWindow</code></a></h3>
<p>It keeps position of the view in the data store. So if you are showing records 5-10 you will always show records from 5-10 whatever they are. To understand
it better let's talk about it on examples.</p>
<p>All examples start with data store containing data <code>[0-&gt;a, 1-&gt;b, 2-&gt;c, 3-&gt;d, 4-&gt;e, 5-&gt;f, 6-&gt;g]</code>. Our view shows the range <code>[2, 5)</code> so user can see <code>[c, d, e]</code>.</p>
<p>If user inserts data at position before the range shown by the view for example at position <code>1 -&gt; a'</code> the data store then looks like
<code>[0-&gt;a, 1-&gt;a', 2-&gt;b, 3-&gt;c, 4-&gt;d, 5-&gt;e, 6-&gt;f, 7-&gt;g]</code>. View is expected to always show records from <code>[2, 5)</code> so view will be updated to user can see <code>[b, c, d]</code>.</p>
<p>If user inserts data inside the range <code>[2, 5)</code>. For example <code>3-&gt;c'</code> then ui will be updated so user can see <code>[c, c', d]</code>.</p>
<p>If user inserts at position <code>5</code> or higher ui will not be updated since there is nothing to do.</p>
<p>This kind of behavior works the best when you use some kind of pagination widget to navigate the data.</p>
<h3 id="storewindowvaluetrackingwindow"><a class="header" href="#storewindowvaluetrackingwindow"><code>store::window::ValueTrackingWindow</code></a></h3>
<p>This kind of window behavior tries to keep current data in the view as much as possible.</p>
<p>All examples start with data store containing data <code>[0-&gt;a, 1-&gt;b, 2-&gt;c, 3-&gt;d, 4-&gt;e, 5-&gt;f, 6-&gt;g]</code>. Our view shows the range <code>[2, 5)</code> so user can see <code>[c, d, e]</code>.</p>
<p>If you insert data at position before range start for example <code>1-&gt;a'</code> then position of the view will be adjusted to <code>[3, 6)</code> so data visible won't change.</p>
<p>If you insert data in the range then nothing we can do about data preservation. For example <code>3-&gt;c'</code> will end up as <code>[c, c', d]</code>.</p>
<p>If you insert data at position <code>5</code> or hight ui will not be updated and store view will still show the same range.</p>
<p>This kind of behavior works the best with scrolling. It makes interface feel more static then with <code>PositionTrackingWindow</code>. If you have a data generated at
the time user is seeing them and for some reason you can't use pagination this will be the best choice for you. Your users will scroll to the data they are
interested into and whatever happens to the data the view will try it's best to keep them in scope.</p>
<h3 id="storewindowkeeponbottom"><a class="header" href="#storewindowkeeponbottom"><code>store::window::KeepOnBottom</code></a></h3>
<p>Keeps the view at the certain distance from the end of data. This way if your sorting is stable in terms of adding new records users will see a log like view
of data.</p>
<p>All examples start with data store containing data <code>[0-&gt;a, 1-&gt;b, 2-&gt;c, 3-&gt;d, 4-&gt;e, 5-&gt;f, 6-&gt;g]</code>. Our view shows the range <code>[2, 5)</code> so user can see <code>[c, d, e]</code>.</p>
<p>If you add the record at <code>1-&gt;a'</code> then change would be ignored since distance from the end of the data did not change.</p>
<p>If you add the record inside the data range for example <code>3-&gt;c'</code> then the data store looks like <code>[0-&gt;a, 1-&gt;b, 2-&gt;c, 3-&gt;c', 4-&gt;d, 5-&gt;e, 6-&gt;f, 7-&gt;g]</code> this means that
keep the distance from the end we need to slide the window to the right so the range would be <code>[3, 6)</code> which in consequence show the user a data <code>[c', d, e]</code>.</p>
<p>If you add the record at position after the data range shown to the user, for example <code>7-&gt;h</code> to keep the distance from the end we need to slide the window to the
right so user would see <code>[d. e. f]</code>.</p>
<p>It's intended for log like views. It's useful in special cases.</p>
<h3 id="storewindowkeepontop"><a class="header" href="#storewindowkeepontop"><code>store::window::KeepOnTop</code></a></h3>
<p>It's reverse of <code>KeepOnBottom</code> where the distance kept is from the beginning of the data (from position <code>0</code>). It's another special case behavior.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../examples/03-todo/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../examples/03-todo/02-custom_sorting.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../examples/03-todo/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../examples/03-todo/02-custom_sorting.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
